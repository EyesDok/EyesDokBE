{% extends 'base.html' %}
{% load static %}
{%block title %}눈똑들이다{% endblock%}
{% block link %}
    <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href='https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css'>
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Kyobo+Handwriting 2022&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/Inform.css' %}">
    <script type="text/javascript" src="{% static 'js/script.js' %}"></script>
{% endblock %}
{% block content %} 
        <section id="sec1">
        <div class="titlecon">
        <p class="maintitle">{{ post.title }}</p>
    </div>

    <div class="titlebutton">
        <div class="button-container">
            <div class="custom-button">등산</div>
            <div class="custom-button">낚시</div>
        </div>
    </div>
    
        

    <section class="gallery">
        

        <div class="center-section">
            <div class="picAndNameContainer">
                <div class="picAndName">
                    <div class="imgContainer">
                        {% if post.images.exists %}
                            <img src="{{ post.images.all.0.image.url }}" alt="">
                        {% else %}
                            <img src="http://via.placeholder.com/300x300">
                        {% endif %}
                    </div>
                    <p class="spot">위치</p>
                    <p class="infor">{{ post.location }}</p>
                    <p class="spot">한줄 눈똑</p>
                    <p class="infor">{{ post.summary }}</p>
                </div>
                <div class="picAndName">
                    <div class="imgContainer">
                        {% if post.images.exists %}
                            <img src="{{ post.images.all.1.image.url }}" alt="">
                        {% else %}
                            <img src="http://via.placeholder.com/300x300">
                        {% endif %}
                    </div>
                    <p class="spot">주차</p>
                    <p class="infor">{{ post.parking }}</p>
                    <p class="spot">예약</p>
                    <p class="infor">{{ post.reservation }}</p>
                </div>
                <div class="picAndName1">
                    <div class="imgContainer">
                        {% if post.images.exists %}
                            <img src="{{ post.images.all.2.image.url }}" alt="">
                        {% else %}
                            <img src="http://via.placeholder.com/300x300">
                        {% endif %}
                    </div>
                    <p class="spot">눈똑 수</p>
                    <p class="infor1">{{ post.like_count }}</p>
                </div>
            </div>
            
        </div>
    </section>
</section>
        <section class="chat">
                <div id="comment">실시간 눈똑 근황</div>
        
                <div id="comment-write">
                    <img id="cuser1" src="{% static 'img/user2.png' %}">
                    <span>{{user.username}}</span>
                    <textarea placeholder="해당 게시물에 대한 00님의 생각을 적어주세요."></textarea>
                    <div id="cbtn1">등록</div>
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", () => {
                        const commentBtn = document.getElementById("cbtn1");
                        const commentTextarea = document.getElementById("comment-textarea");
                    
                        commentBtn.addEventListener("click", () => {
                            const content = commentTextarea.value;
                    
                            if (content.trim() === "") {
                                alert("댓글 내용을 입력하세요.");
                                return;
                            }
                    
                            // AJAX 요청을 보내고 서버에서 댓글을 추가하도록 처리
                            // 아래 코드에서 url을 실제 댓글 추가 URL로 변경해야 합니다.
                            fetch("/your-comment-add-url/", {
                                method: "POST",
                                headers: {
                                    "X-CSRFToken": "{{ csrf_token }}",
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify({ content: content }),
                            })
                            .then(response => response.json())
                            .then(data => {
                                // 처리 완료 후, 페이지 리로드 또는 동적으로 댓글 표시 처리
                                location.reload(); // 이 부분을 원하는 처리 방식으로 변경할 수 있습니다.
                            })
                            .catch(error => {
                                console.error("Error:", error);
                            });
                        });
                    });
                    </script>
                
                {% for comment in comments %}
                <div id="comment-write1">
                    <img id="cuser1" src="{% static 'img/user2.png' %}">
                    <span>{{ comment.writer.username }}</span>
                    <div id="text-container">
                        <div id="ctext2">
                            {{ comment.content }}
                        </div>
                    </div>
                </div>
                {% endfor %}

                <div id="buttons-container">

                    <a href="{% url 'noonddockApp:noonddock' %}" class="custom-button2" id="button1">
                        눈똑들이기
                        <button class="custom-button2"></button>
                    </a>
                    <button class="custom-button1" id="button2" onclick="goBack()">목록으로 가기</button>
                        <script>
                            function goBack() {
                                window.history.back();
                            }
                        </script>
                    </a>
                </div>
               
        
            


        </section>
{% endblock %}